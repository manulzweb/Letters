<div class="main-layout" *ngIf="letterService.selectedLetter(); else selectorView">
    <ng-container *ngIf="letterService.isTransitioning(); else envelopeView">
        <app-intro [letter]="letterService.selectedLetter()"></app-intro>
    </ng-container>

    <ng-template #envelopeView>
        <div class="envelope-container">
            <button class="back-btn" (click)="letterService.clearSelection()">
                ← Volver al menú
            </button>

            <app-envelope></app-envelope>

            <div class="controls-wrapper">
                <app-controls></app-controls>
            </div>
        </div>
    </ng-template>
</div>

<ng-template #selectorView>
    <app-selector></app-selector>
</ng-template>

<!-- Heart Rain Effect -->
<div class="rain-container" *ngIf="letterService.isOpen()">
    <div class="falling-heart" *ngFor="let heart of hearts" [style.left]="heart.left"
        [style.animation-duration]="heart.animationDuration" [style.animation-delay]="heart.animationDelay"
        [style.opacity]="heart.opacity">
        ❤️
    </div>
</div>

<router-outlet></router-outlet>